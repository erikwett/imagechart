define("extensions/imagechart/util",["qlik"],function(e){"use strict";function t(e,t,n){var r=document.createElement(e);return t&&(r.className=t),n!==undefined&&(r.innerHTML=n),r}function n(e,t){e.childNodes.length===0?e.appendChild(t):e.replaceChild(t,e.childNodes[0])}function r(e){var n=t("link");n.rel="stylesheet",n.type="text/css",n.href=require.toUrl(e),document.head.appendChild(n)}return{createElement:t,setChild:n,addStyleSheet:r}}),define("extensions/imagechart/properties",["qlik"],function(e){var t=[{value:"repeat"},{value:"no-repeat"},{value:"space"},{value:"round"}],n={type:"items",component:"accordion",items:{dimensions:{uses:"dimensions",min:1,max:1},measures:{uses:"measures",min:1,max:2},sorting:{uses:"sorting"},imagesection:{type:"items",label:"Orientation and image",items:{orientation:{type:"string",label:"Orientation",ref:"orientation",component:"dropdown",options:[{value:"vertical",label:"Vertical"},{value:"horizontal",label:"Horizontal"}]},image:{ref:"image",label:"Image",type:"string",component:"dropdown",options:function(){return e.currApp().getList("MediaList").then(function(e){return e.getLayout().then(function(){return[{value:"",label:"No image"},{value:"link",label:"Link"},{value:"meas",label:"2nd measure"}].concat(e.layout.qMediaList.qItems.map(function(e){return{value:e.qUrlDef,label:e.qUrlDef}}))})})}},imageurl:{ref:"imageurl",label:"Link",type:"string",expression:"optional",show:function(e){return e.image==="link"}},bgcolor:{ref:"bgcolor",label:"Background color",type:"string",expression:"optional"},horizrepeat:{ref:"repeatx",label:"Horiz repeat",type:"string",component:"dropdown",options:t,defaultValue:"repeat"},vertrepeat:{ref:"repeaty",label:"Vert repeat",type:"string",component:"dropdown",options:t,defaultValue:"repeat"}}},widthsection:{type:"items",label:"Width and styling",items:{barwidth:{ref:"barwidth",label:"Bar Width",type:"number",defaultValue:60},spacing:{ref:"spacing",label:"Spacing",type:"number",defaultValue:10},barstyle:{ref:"barstyle",label:"Bar style",type:"string",expression:"optional",defaultValue:"border: 1px solid grey;"},labelstyle:{ref:"labelstyle",label:"Label style",type:"string",expression:"optional",defaultValue:"font-weight:bold;"}}},scalesection:{type:"items",label:"Scale and Gridlines",items:{min:{ref:"min",label:"Min",type:"number"},max:{ref:"max",label:"Max",type:"number"},grid:{ref:"showGrid",label:"Show gridlines",type:"boolean"},step:{ref:"step",label:"Step",type:"number",show:function(e){return e.showGrid}}}},settings:{uses:"settings"}}};return n}),define(["./util","./properties"],function(e,t){"use strict";function n(e,t){var n="";return e.image==="link"?'url("'+e.imageurl+'")':(e.image==="meas"?t&&(n='url("'+t.qText+'")'):e.image&&e.qMediaList.qItems.forEach(function(t){t.qUrlDef===e.image&&(n='url("'+t.qUrl+'")')}),n)}function r(e,t){var n=Math.round((t-e)/5),r=Math.trunc(Math.log10(n)),i=Math.pow(10,r);return n=Math.round(n/i)*i,n}function i(e,t,n){return(n-e)*100/t}function s(t,n,s,o){var u=o.step||r(n,s),a=e.createElement("div","grid");for(var f=n;f<=s;f+=u){var l=e.createElement("span","gridlabel",f),c=e.createElement("div","gridline"),h=i(n,s,f)+"%";o.orientation==="horizontal"?(l.style.left=h,c.style.left=h):(l.style.bottom=h,c.style.bottom=h),a.appendChild(l),a.appendChild(c)}t.appendChild(a)}function o(e,t,n){e.className+=" selectable",e.onclick=function(){t.selectValues(0,[n],!0),this.classList.toggle("selected")}}return e.addStyleSheet("extensions/imagechart/imagechart.css"),{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:5,qHeight:50}]},qMediaListDef:{}},definition:t,snapshot:{canTakeSnapshot:!0},paint:function(t,r){var u=this,a=0,f=r.spacing||10,l=r.barwidth||60,c=r.min||0,h=r.max||r.qHyperCube.qMeasureInfo[0].qMax,p=r.orientation==="horizontal",d=p?t.width()-130:t.height()-40,v=n(r),m=e.createElement("div",p?"horiz":"vert"),g=e.createElement("div","scroll");r.showGrid&&s(m,c,h,r),m.appendChild(g),r.qHyperCube.qDataPages.forEach(function(s){s.qMatrix.forEach(function(t){var s=t[0],m=t[1];s.qIsOtherCell&&(s.qText=r.qHyperCube.qDimensionInfo[0].othersLabel),r.image==="meas"&&(v=n(r,t[2]));var y=e.createElement("div","row");y.title=s.qText+": "+m.qText,s.qElemNumber!==-1&&o(y,u,s.qElemNumber);var b=e.createElement("div","label",s.qText);r.labelstyle&&b.setAttribute("style",r.labelstyle),y.appendChild(b);var E=e.createElement("div","bar");r.barstyle&&E.setAttribute("style",r.barstyle),p?(E.style.height=l+"px",E.style.width=i(c,h,m.qNum)*d/100+"px",y.style.height=l+f+"px"):(E.style.width=l+"px",E.style.height=i(c,h,m.qNum)*d/100+"px",y.style.left=a+"px",a+=l+f),E.style.backgroundImage=v,E.style.backgroundRepeatX=r.repeatx,E.style.backgroundRepeatY=r.repeaty,E.style.backgroundColor=r.bgcolor,y.appendChild(E),g.appendChild(y)});var y=t[0];y.childNodes.length===0?y.appendChild(m):y.replaceChild(m,y.childNodes[0])})}}});